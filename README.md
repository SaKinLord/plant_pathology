# Plant Pathology Classification - Apple Leaf Diseases üçéüåø

A PyTorch-based deep learning model for detecting apple leaf diseases (healthy, multiple_diseases, rust, scab) using a pre-trained SE-ResNeXt50 architecture. This project includes data exploration, augmentation, stratified data splitting, model training, evaluation, and a pipeline for generating submission-ready predictions.

PyTorch License: MIT Kaggle Dataset

## Key Features

*   **Model:** Pre-trained SE-ResNeXt50 (specifically `resnext50_32x4d` from `torchvision.models`) with a custom classification head.
*   **Framework:** PyTorch.
*   **Multi-Label Classification:** Correctly handles images that can have multiple disease labels simultaneously using Binary Cross-Entropy with Logits Loss (`BCEWithLogitsLoss`).
*   **Data Augmentation:**
    *   Random Resized Crop
    *   Random Horizontal & Vertical Flips
    *   Random Rotation
    *   Color Jitter (brightness, contrast, saturation, hue)
*   **Data Handling:**
    *   Custom `AppleLeafDataset` and `DataLoader` for efficient data loading and batching.
    *   Stratified train-validation split to maintain class proportions across sets.
*   **Training Pipeline:**
    *   Adam optimizer.
    *   `ReduceLROnPlateau` learning rate scheduler to adjust learning rate based on validation loss.
    *   Saves the best performing model (based on validation loss) during training.
    *   Plots training and validation loss/accuracy curves.
*   **Comprehensive Evaluation:**
    *   Overall Accuracy.
    *   Per-class F1-score, Precision, and Recall on the validation set.
*   **Prediction & Submission:**
    *   Generates a `submission.csv` file in the format required for the Kaggle competition.
*   **Reproducibility:** Sets random seeds for NumPy and PyTorch for more consistent results.
*   **Initial Data Exploration:** Includes visualization of class distribution and sample images.

## Dataset

This project uses the **Plant Pathology 2020 - FGVC7** dataset from Kaggle.
*   **Link:** [https://www.kaggle.com/competitions/plant-pathology-2020-fgvc7/data](https://www.kaggle.com/competitions/plant-pathology-2020-fgvc7/data)

You will need to download:
*   `train.csv`
*   `test.csv`
*   `images` (directory containing all `.jpg` image files)

## Project Structure (Example)

It's recommended to organize your project as follows. The script `seresnext50_(1).py` uses a `BASE_DIR` variable that you'll need to set to your project's root.
your-project-root/
‚îú‚îÄ‚îÄ images/ # Directory containing all image files (Test_0.jpg, Train_0.jpg, etc.)
‚îÇ ‚îú‚îÄ‚îÄ Test_0.jpg
‚îÇ ‚îú‚îÄ‚îÄ Train_0.jpg
‚îÇ ‚îî‚îÄ‚îÄ ...
‚îú‚îÄ‚îÄ seresnext50_(1).py # Main PyTorch training and prediction script
‚îú‚îÄ‚îÄ train.csv # Training data labels
‚îú‚îÄ‚îÄ test.csv # Test set image IDs
‚îú‚îÄ‚îÄ best_model.pth # Saved best model weights (generated by script)
‚îú‚îÄ‚îÄ submission.csv # Generated submission file (generated by script)
‚îî‚îÄ‚îÄ README.md

## Setup

1.  **Clone the repository (or download the files):**
    ```bash
    git clone https://github.com/SaKinLord/plant-pathology.git
    cd plant-pathology
    ```

2.  **Create a Python environment (recommended):**
    ```bash
    python -m venv venv
    source venv/bin/activate  # On Windows: venv\Scripts\activate
    ```

3.  **Install dependencies:**
    You'll need libraries like PyTorch, Torchvision, Pandas, NumPy, Matplotlib, Seaborn, Pillow, and Scikit-learn. You can create a `requirements.txt` file with contents like:
    ```txt
    pandas
    numpy
    matplotlib
    seaborn
    Pillow
    torch
    torchvision
    scikit-learn
    ```
    Then install using:
    ```bash
    pip install -r requirements.txt
    ```
    Or install them individually:
    ```bash
    pip install pandas numpy matplotlib seaborn Pillow torch torchvision scikit-learn
    ```

4.  **Download the dataset:**
    *   Go to the Kaggle dataset page: [Plant Pathology 2020 - FGVC7 Data](https://www.kaggle.com/competitions/plant-pathology-2020-fgvc7/data)
    *   Download `train.csv`, `test.csv`, and the `images.zip` (or individual image files).
    *   Extract `images.zip` if necessary.
    *   Place `train.csv`, `test.csv`, and the `images` folder into your project directory (e.g., `your-project-root/` as shown in the structure above).

## Usage

1.  **Configure `BASE_DIR`:**
    Open the `seresnext50_(1).py` script and modify the `BASE_DIR` variable to point to the root directory where you placed the dataset files (`train.csv`, `test.csv`, `images/`).
    ```python
    # In seresnext50_(1).py, around line 58:
    BASE_DIR = '/path/to/your/project-root' # e.g., '.' if script is in the same folder as images, train.csv etc.
    # Example for Google Colab (as in the original script):
    # BASE_DIR = '/content/drive/MyDrive/Colab Notebooks/plant-pathology'
    ```

2.  **Run the script:**
    ```bash
    python seresnext50_(1).py
    ```
    The script will:
    *   Perform initial data exploration (printing shapes, class distributions, showing sample images).
    *   Prepare datasets and dataloaders for training and validation.
    *   Initialize and train the SE-ResNeXt50 model.
        *   Training progress (loss, validation metrics) will be printed per epoch.
        *   The best model weights will be saved to `best_model.pth` in your `BASE_DIR`.
    *   Plot training/validation loss and validation accuracy curves.
    *   Evaluate the best model on the validation set, printing detailed metrics (Accuracy, F1, Precision, Recall per class).
    *   Generate predictions on the test set and save them to `submission.csv` in your `BASE_DIR`.

## Results

The model's performance will be printed at the end of the training and evaluation phase. The script aims for high classification accuracy and F1-scores on the validation set. The original README mentioned "Achieves 97.5% validation accuracy"; this is a target and actual results may vary based on the specific training run, number of epochs, and compute resources.

---

This updated README should provide a good overview and guide for users of your project. Remember to adjust paths and any specific version numbers in `requirements.txt` as needed for your environment.
